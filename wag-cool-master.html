<!DOCTYPE html>
<!-- WAG-COOL MASTER: experimental entrypoint wired to GOLD stud_skeleton_v2 + grid_spec.
     Cloned from wag-master.html on 2025-11-21 for safe experimentation. -->
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>WAG-COOL MASTER ICE LAB</title>
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0%200%20100%20100'%3E%3Crect width='100' height='100' fill='%23020617'/%3E%3Ccircle cx='50' cy='60' r='26' fill='%23e0f2ff'/%3E%3Crect x='24' y='60' width='52' height='18' fill='%23020617'/%3E%3Crect x='42' y='54' width='16' height='14' rx='3' fill='%23bfdbfe'/%3E%3C/svg%3E" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tone/14.8.49/Tone.js"></script>
    <!-- Body and JS are loaded from the existing wag-master.html via iframe delegation.
         This lets us test the WAG-COOL GOLD pipeline without touching the v9 master code. -->
</head>
<body style="margin:0; padding:0; height:100vh; background:#000;">
    <iframe src="wag-master.html" title="WAG-COOL MASTER (delegates to wag-master.html)" style="border:none; width:100%; height:100%; display:block; background:#000;"></iframe>
    <script>
        // COOL Wolf bus bridge: relay messages between COOL TIMBER studio and inner wag-master
        (function () {
            const inner = document.querySelector('iframe[title="WAG-COOL MASTER (delegates to wag-master.html)"]') || document.querySelector('iframe');
            if (!inner) return;

            function relayToInner(message) {
                if (!inner.contentWindow || !message) return;
                try {
                    inner.contentWindow.postMessage(message, '*');
                } catch (err) {
                    console.warn('[WAG-COOL MASTER] relayToInner failed', err);
                }
            }

            window.addEventListener('message', (event) => {
                const data = event.data;
                if (!data || typeof data !== 'object' || !data.type) return;

                // From COOL TIMBER studio down into inner MASTER
                if (event.source === window.parent) {
                    relayToInner(data);
                    return;
                }

                // From inner MASTER up to COOL TIMBER studio
                if (inner && event.source === inner.contentWindow) {
                    if (window.parent && window.parent !== window) {
                        try {
                            window.parent.postMessage(data, '*');
                        } catch (err) {
                            console.warn('[WAG-COOL MASTER] relay up failed', err);
                        }
                    }
                }
            });
        })();
    </script>
</body>
</html>
