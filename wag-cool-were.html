<!DOCTYPE html>
<!-- WAG-COOL WERE: experimental entrypoint wired to GOLD stud_skeleton_v2 + grid_spec.
     Cloned from wag-were.html on 2025-11-21 for safe experimentation. -->
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>WAG-COOL WERE ICE LAB</title>
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0%200%20100%20100'%3E%3Crect width='100' height='100' fill='%23020617'/%3E%3Crect x='20' y='25' width='60' height='50' rx='10' fill='%2338bdf8'/%3E%3Crect x='26' y='31' width='48' height='38' rx='8' fill='%23e0f2ff'/%3E%3C/svg%3E" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tone/14.8.49/Tone.js"></script>
    <!-- Body and JS are loaded from the existing wag-were.html via iframe-style include pattern.
         For now, WAG-COOL delegates behavior to wag-were.html so we can switch entrypoints
         without duplicating code; future iterations can inline and specialize if needed. -->
</head>
<body style="margin:0; padding:0; height:100vh; background:#000;">
    <iframe src="wag-were.html" title="WAG-COOL WERE (delegates to wag-were.html)" style="border:none; width:100%; height:100%; display:block; background:#000;"></iframe>
    <script>
        // COOL Wolf bus bridge: relay messages between COOL TIMBER studio and inner wag-were
        (function () {
            const inner = document.querySelector('iframe[title="WAG-COOL WERE (delegates to wag-were.html)"]') || document.querySelector('iframe');
            if (!inner) return;

            function relayToInner(message) {
                if (!inner.contentWindow || !message) return;
                try {
                    inner.contentWindow.postMessage(message, '*');
                } catch (err) {
                    console.warn('[WAG-COOL WERE] relayToInner failed', err);
                }
            }

            window.addEventListener('message', (event) => {
                const data = event.data;
                if (!data || typeof data !== 'object' || !data.type) return;

                // From COOL TIMBER studio down into inner WERE
                if (event.source === window.parent) {
                    relayToInner(data);
                    return;
                }

                // From inner WERE up to COOL TIMBER studio
                if (inner && event.source === inner.contentWindow) {
                    if (window.parent && window.parent !== window) {
                        try {
                            window.parent.postMessage(data, '*');
                        } catch (err) {
                            console.warn('[WAG-COOL WERE] relay up failed', err);
                        }
                    }
                }
            });
        })();
    </script>
</body>
</html>
